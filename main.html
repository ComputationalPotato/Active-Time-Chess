<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-time Chessboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/chessboard-1.0.0.min.css">
    <link rel="stylesheet" href="styles.css"> <!-- Link to external CSS file -->
</head>

<body>
    <div class="board-container">
        <div id="myBoard" style="width: 400px"></div>
    </div>
    <div class="button-container">
        <button id="startBtn">Start Position</button>
        <button id="clearBtn">Clear Board</button>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/chessboard-1.0.0.js"></script>

    <script type="module">
        import { isLegalMove, isPathBlocked } from './gamelogic.js';

        $(document).ready(function () {
            let board = null;

            var config = {
                draggable: true,
                position: 'start',
                onDrop: function (source, target, piece, newPos, oldPos, orientation) {
                    console.log('Attempting move from ' + source + ' to ' + target);

                    // Check if move is legal using imported function
                    if (!isLegalMove(source, target, piece, newPos, oldPos)) {
                        console.log('Illegal move attempted');
                        return 'snapback';
                    }

                    console.log('Move successful');
                    return true;
                },
                onDragStart: function (source, piece, position, orientation) {
                    return true;
                },
                onChange: function (oldPos, newPos) {
                    console.log('Board position changed');
                }
            };

            // Initialize board
            board = Chessboard('myBoard', config);
            console.log('Board initialized');

            // Add button handlers
            $('#startBtn').on('click', function () {
                board.start();
                console.log('Board reset to start position');
            });

            $('#clearBtn').on('click', function () {
                board.clear();
                console.log('Board cleared');
            });

            // Make board responsive
            $(window).resize(function () {
                board.resize();
            });
        });
    </script>
</body>

</html>